/* ========== THEME SYSTEM ========== */
:root {
  --font: "Inter", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  --radius-lg: 16px;
  --radius-sm: 10px;
  --dur: .18s;
  --shadow-1: 0 6px 20px rgba(0,0,0,.35);
  --shadow-2: 0 10px 30px rgba(0,0,0,.45);
  --blur: 10px;

  /* default (dark) */
  --bg: #0d1117;
  --bg-2: #0b0f14;
  --panel: rgba(22, 27, 34, .7);
  --panel-solid: #161b22;
  --text: #e6e8eb;
  --muted: #9aa3ad;
  --border: #2b313a;
  --accent: #ffd369;
  --accent-2: #f7c23b;
  --success: #7bd389;
  --danger: #ff6b6b;
}

html[data-theme="midnight"] {
  --bg: #070a12;
  --bg-2: #05070d;
  --panel: rgba(13,18,30,.68);
  --panel-solid: #0e1422;
  --text: #e2e7ff;
  --muted: #9aa7d1;
  --border: #1a2240;
  --accent: #7aa2ff;
  --accent-2: #5f8cff;
}

html[data-theme="aqua"] {
  --bg: #061414;
  --bg-2: #051010;
  --panel: rgba(10,30,30,.7);
  --panel-solid: #0b2222;
  --text: #e3fbfb;
  --muted: #99caca;
  --border: #123333;
  --accent: #5eead4;
  --accent-2: #2dd4bf;
}

html[data-theme="crimson"] {
  --bg: #14080a;
  --bg-2: #0f0608;
  --panel: rgba(32, 10, 14, .7);
  --panel-solid: #1e0a0f;
  --text: #ffe9ec;
  --muted: #f2a6b1;
  --border: #331018;
  --accent: #ff6b8a;
  --accent-2: #ff5174;
}

* { box-sizing: border-box }
html, body { height: 100% }
body {
  margin: 0;
  min-height: 100vh;
  display: flex; flex-direction: column;
  background: radial-gradient(1000px 600px at 70% -10%, var(--bg-2), transparent 60%), var(--bg);
  color: var(--text);
  font-family: var(--font);
  letter-spacing: .2px;
  -webkit-font-smoothing: antialiased;
}

.bg-grid {
  position: fixed; inset: 0; z-index: -2; pointer-events: none;
  background-image:
    linear-gradient(to right, rgba(255,255,255,.04) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(255,255,255,.04) 1px, transparent 1px);
  background-size: 40px 40px;
  opacity: .35;
}
.bg-glow {
  position: fixed; inset: -20vmax; z-index: -1; pointer-events:none;
  background:
    radial-gradient(1000px 600px at 15% 10%, var(--accent-2, var(--accent))20%, transparent 60%),
    radial-gradient(900px 500px at 90% 90%, rgba(255,255,255,.06), transparent 65%);
  filter: blur(50px) saturate(120%);
  opacity: .18;
}

/* ========== GLASS / SOFT UI ========== */
.glass {
  background: var(--panel);
  backdrop-filter: blur(var(--blur));
  -webkit-backdrop-filter: blur(var(--blur));
  border: 1px solid var(--border);
  box-shadow: var(--shadow-1);
}
.soft {
  background: linear-gradient(145deg, rgba(255,255,255,.04), rgba(0,0,0,.2));
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-1);
}

/* ========== TOPBAR ========== */
.topbar {
  display:flex; align-items:center; justify-content:space-between;
  padding: 14px 18px; border-bottom: 1px solid var(--border);
}
.topbar h1 { margin: 0; font-size: 20px; font-weight: 800; letter-spacing:.4px }
.topbar-right { display:flex; gap:10px; align-items:center }
.pill {
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.2));
  padding: 4px 10px; border-radius: 999px; font-size:12px; border:1px solid var(--border); color: var(--muted);
}
.toggle { display:flex; align-items:center; gap:6px; font-size: 13px; color: var(--muted) }
.toggle input { accent-color: var(--accent) }
.link { background:none; border:none; cursor:pointer; color:var(--muted) }
.link:hover { color: var(--danger) }

/* Theme tools */
.theme-tools { display:flex; align-items:center; gap:8px; margin-right:8px }
.theme-select {
  appearance:none; background: var(--panel-solid); color: var(--text);
  border: 1px solid var(--border); border-radius: 10px; padding: 6px 10px; font-weight:600; cursor:pointer;
}
.accent-picker { position:relative; width:28px; height:28px; display:inline-flex; }
.accent-picker input { position:absolute; inset:0; opacity:0; cursor:pointer }
.accent-picker .swatch {
  width:28px; height:28px; border-radius:8px;
  border:1px solid var(--border); background: var(--accent);
  box-shadow: inset 0 0 0 2px rgba(0,0,0,.15), 0 2px 8px rgba(0,0,0,.35);
}

/* ========== LAYOUT ========== */
.layout {
  flex:1; display:grid; gap:20px; padding:20px; overflow:hidden;
  grid-template-columns: 1.25fr 1fr;
}
.panel { border-radius: 20px; padding: 18px; display:flex; flex-direction:column; height:100% }
.shop-panel { min-height:0 }

/* ========== TABS ========== */
.tabs { display:flex; gap:8px; align-items:center; margin:-6px 0 12px }
.tab {
  padding: 8px 12px; border:1px solid var(--border);
  background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(0,0,0,.12));
  color: var(--muted); border-radius: 12px; cursor:pointer; font-weight: 700;
  transition: transform var(--dur) ease, border-color var(--dur), background var(--dur), color var(--dur);
}
.tab:hover { transform: translateY(-1px); border-color: var(--accent) }
.tab.active { color:#111; background: var(--accent); border-color: var(--accent-2); box-shadow: 0 6px 18px rgba(0,0,0,.35) }

.qty { margin-left:auto; display:flex; gap:6px }
.qty-btn {
  padding:6px 10px; border:1px solid var(--border);
  background: var(--panel-solid); color: var(--muted);
  border-radius: 10px; cursor:pointer; font-weight: 700;
}
.qty-btn.active { background: #2a2f38; color:#fff; border-color:#3a4150 }

/* ========== RESOURCE CARD ========== */
.resource-card { text-align:center; margin-bottom: 16px; position:relative; padding:16px }
.resource-name { font-size:14px; color:var(--muted) }
.resource-amount { font-size:64px; font-weight:800; margin:4px 0 6px; color: var(--accent);
  text-shadow: 0 0 24px color-mix(in oklab, var(--accent), #000 40%); transition: transform .12s ease }
.resource-amount.bump { transform: scale(1.06) }
.rates { color:var(--muted); margin-bottom: 12px; display:flex; gap:12px; justify-content:center }

/* Buttons */
.btn {
  position:relative; overflow:hidden;
  font-size:16px; font-weight:800; padding:12px 18px; border:none; border-radius:14px; cursor:pointer;
  transition: transform var(--dur), filter var(--dur), background var(--dur), box-shadow var(--dur);
  box-shadow: inset 0 -2px 0 rgba(0,0,0,.3), var(--shadow-1);
}
.btn.primary { background: var(--accent); color: #111 }
.btn.primary:hover { filter:brightness(1.05) }
.btn.success { background: linear-gradient(180deg, #6ee7b7, #34d399); color:#062d1e }
.btn.danger { background: linear-gradient(180deg, #ff8aa0, #ff6b6b); color:#290a0f }
.btn:active { transform: translateY(1px) scale(.99) }

.btn .ripple { position:absolute; pointer-events:none; width:14px; height:14px; border-radius:50%;
  background: rgba(255,255,255,.45); transform:translate(-50%,-50%) scale(0); animation:ripple .45s ease-out forwards }
@keyframes ripple { to { transform: translate(-50%,-50%) scale(18); opacity:0 } }

.inline { display:flex; gap:10px; margin-top:10px }

/* Multi resource badges */
.multi-res { display:flex; flex-wrap:wrap; gap:10px; margin-bottom:14px }
.res-badge {
  display:flex; align-items:center; gap:8px; padding:8px 10px;
  border:1px solid var(--border); background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(0,0,0,.18));
  border-radius: 999px; box-shadow: 0 1px 6px rgba(0,0,0,.25)
}
.res-badge img { width:20px; height:20px }
.res-badge .rname { color: var(--muted); font-size:12px }
.res-badge .rval { font-weight:800 }

/* ========== LISTS ========== */
.tabpane { display:none; flex:1; min-height:0 }
.tabpane.active { display:flex; flex-direction:column; min-height:0 }
.tabhead { display:flex; align-items:center; justify-content:space-between; gap: 8px }
.rp { color: var(--muted) }

.upgrade-list {
  flex:1; min-height:0; overflow-y:auto; padding-right:6px;
  display:flex; flex-direction:column; gap:12px;
}
.upgrade-list::-webkit-scrollbar { width:10px }
.upgrade-list::-webkit-scrollbar-track { background: transparent }
.upgrade-list::-webkit-scrollbar-thumb { background:#2b2f37; border-radius: 8px; border:1px solid #1b1e24 }
.upgrade-list::-webkit-scrollbar-thumb:hover { background:#343844 }

/* Card */
.upgrade-btn {
  background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(0,0,0,.22));
  border:1px solid var(--border);
  border-radius: 14px; padding: 12px; cursor:pointer; text-align:left;
  transition: transform var(--dur), border-color var(--dur), box-shadow var(--dur), background var(--dur);
  box-shadow: var(--shadow-1);
}
.upgrade-btn strong { font-size: 16px; color: var(--accent) }
.upgrade-btn span { display:block; font-size: 13px; color: var(--muted) }
.upgrade-btn:hover { transform: translateY(-2px); border-color: var(--accent); box-shadow: var(--shadow-2) }
.upgrade-btn:disabled { opacity:.55; cursor:not-allowed }

/* Building specifics */
.build-card { display:flex; justify-content:space-between; align-items:center; gap:12px }
.build-meta { display:flex; flex-direction:column }
.build-name { font-weight:800; color: var(--accent) }
.build-desc { color: var(--muted); font-size:13px }
.build-owns { color:#cbd5e1; font-size:13px }
.build-cost { font-size:13px; color:#cbd5e1 }
.build-prod { font-size:12px; color:#9ca3af }
.build-buy {
  padding:8px 10px; border:none; background: var(--accent); color:#111; border-radius:10px; font-weight:800; cursor:pointer;
  box-shadow: inset 0 -1px 0 rgba(0,0,0,.25), 0 6px 14px rgba(0,0,0,.25);
}
.build-buy:disabled { opacity:.6; cursor:not-allowed }

/* Milestone & Prestige */
.milestone, .prestige { margin-top:16px; padding:14px }
.milestone.ready { box-shadow: 0 0 24px rgba(123,211,137,.28), inset 0 0 12px rgba(123,211,137,.13) }
.milestone h3, .prestige h3 { margin:0 0 8px }
.muted { color: var(--muted); font-size:12px }
progress { width:100%; height:14px; border-radius:7px; overflow:hidden; background: #1e2430 }
progress::-webkit-progress-bar{ background:#1e2430 }
progress::-webkit-progress-value{ background: linear-gradient(90deg, var(--success), color-mix(in oklab, var(--success), #fff 22%)) }
progress::-moz-progress-bar{ background: var(--success) }

/* Footer */
.statusbar {
  padding: 12px 20px; font-size: 14px; color: var(--muted);
  border-top: 1px solid var(--border);
}

/* FX */
.float { position:fixed; pointer-events:none; z-index:9997; font-weight:800; font-size:16px; color:#fff;
  text-shadow:0 2px 8px rgba(0,0,0,.6); animation:floatUp .8s ease-out forwards }
.float.small{font-size:14px;opacity:.85}
.float.crit{color:#ffb4b4;text-shadow:0 0 10px rgba(255,100,100,.7)}
@keyframes floatUp { from{ transform:translate(-50%,-30%) scale(.9); opacity:0 } 20%{opacity:1} to{ transform:translate(-50%,-120%) scale(1.08); opacity:0 } }
.confetti{position:fixed;width:8px;height:14px;z-index:9996;pointer-events:none;transform:translate(-50%,-50%) rotate(0);animation:drop 1.1s ease-in forwards}
.confetti.c2{background:#7bd389}.confetti.c3{background:#60a5fa}.confetti.c4{background:#f472b6}
@keyframes drop{from{opacity:0;transform:translateY(-30px) rotate(0)}10%{opacity:1}to{transform:translateY(120vh) rotate(340deg);opacity:0}}
body.celebrate::after{content:"";position:fixed;inset:0;pointer-events:none;z-index:9996;background:radial-gradient(800px 400px at 50% 30%, color-mix(in oklab, var(--accent), #fff 20%) .4, transparent 60%);animation:celebrate .9s ease-out forwards}
@keyframes celebrate{0%{opacity:0}15%{opacity:1}100%{opacity:0}}

@media (max-width: 980px){ .layout{ grid-template-columns:1fr } }
